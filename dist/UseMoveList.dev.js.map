{"version":3,"file":"UseMoveList.dev.js","sources":["../src/core/mouse-handler.js","../src/core/move-block.js"],"sourcesContent":["// 事件\nconst EVENT_TYPE = {\n  click: 'click', // 点击事件\n  press: 'press', // 长按事件\n  pressEnd: 'pressEnd', // 长按结束\n  move: 'move' // 拖拽\n  // 放入插件去判断\n  // toTop: 'toTop', // 上滑\n  // toBottom: 'toBottom', // 下滑\n  // leftToRight: 'leftToRight', // 左->右\n  // rightToleft: 'rightToleft', // 右->左\n  // topEdge: 'topEdge', // 顶部边缘下滑\n  // bottomEdge: 'bottomEdge', // 底部边缘上滑\n  // leftEdge: 'leftEdge', // 左边缘右滑\n  // rightEdge: 'rightEdge', // 右边缘左滑\n};\n\nconst ASSERT_MOVE = 20; // 断言长按与移动,px\nconst ASSERT_PRESS = 300; // 断言点击长按,ms\n\n// 监听一个元素内的鼠标事件\nexport default class MouseHandler {\n  constructor(options) {\n    if (options.el instanceof Node) this.el = options.el;\n    else throw Error('el must be a Element');\n    this.$options = options; // 内含一系列钩子\n    this.initData();\n    /*\n     * 每次鼠标动作都有3个状态\n     * 按下、移动、抬起（down，move，up）\n     * 通过分析动作，确定鼠标操作的场景，并抛出一系列的钩子\n     * --------------------\n     * 场景包括:\n     * 点击 * 长按 * 移动 * 上滑 * 下滑 * 左->右 * 右->左 * 顶部边缘下滑 * 底部边缘上滑 * 左边缘右滑 * 右边缘左滑\n     * --------------------\n     * 钩子包括:\n     * click * press * pressEnd * toTop * toBottom * leftToRight * rightToleft * topEdge * bottomEdge * leftEdge * rightEdge\n     * --------------------\n     * 现在先分析 长按->拖拽 场景\n     * */\n    this.el.addEventListener('mousedown', this.mousedown.bind(this));\n    this.el.addEventListener('mousemove', this.mousemove.bind(this));\n    // this.el.addEventListener('mouseup', this.mouseup.bind(this));\n    document.addEventListener('mouseup', this.mouseup.bind(this));\n  }\n\n  // 初始化值\n  initData() {\n    this.scene = null; // 当前动作场景\n    this.action = null; // 动作状态\n    this.downtime = 0; // 按下时的时间\n    this.uptime = 0; //抬起的时间\n    this.startCoor = { x: 0, y: 0 }; // 按下时鼠标位置\n    this.moveCoor = { x: 0, y: 0 }; // 移动时鼠标位置\n    this.endCoor = { x: 0, y: 0 }; // 放开时时鼠标位置\n    this.stop = false;\n  }\n\n  // 鼠标按下\n  mousedown(e) {\n    if (this.stop) e.stopPropagation();\n    this.setAction('down'); // 鼠标按下\n    this.downtime = new Date().getTime();\n    this.startCoor = { x: e.x, y: e.y };\n    setTimeout(() => {\n      // 当超过断言值时\n      console.log('action------------------------' + this.action);\n      if (this.action && this.action !== 'up' && this.assertPressOrMove().isPress) {\n        this.setScene('press');\n        if (typeof this.press === 'function') this.press(e);\n      }\n    }, this.$options.pressDelay || ASSERT_PRESS);\n  }\n\n  // 鼠标移动\n  mousemove(e) {\n    if (this.stop) e.stopPropagation();\n    this.moveCoor = { x: e.x, y: e.y };\n    // this.setAction('move'); // 鼠标按下\n    if (typeof this.move === 'function') this.move(e, this.startCoor, this.moveCoor);\n  }\n\n  // 鼠标抬起\n  mouseup(e) {\n    if (this.stop) e.stopPropagation();\n    this.setAction('up'); // 鼠标按下\n    this.uptime = new Date().getTime();\n    const during = this.uptime - this.downtime;\n    this.endCoor = { x: e.x, y: e.y };\n    // 断言是点击还是长按：scene未被设置，且点击间隔少于 ASSERT_PRESS\n    if (during <= (this.$options.pressDelay || ASSERT_PRESS)) {\n      this.setScene('click');\n      if (typeof this.click === 'function') this.click(e);\n    } else if (this.assertPressOrMove().isPress) {\n      this.setScene('pressEnd');\n      if (typeof this.pressEnd === 'function') this.pressEnd(e);\n    }\n    this.eventOver();\n  }\n\n  // 断言当前是长按还是移动，\n  assertPressOrMove() {\n    const _x = Math.abs(this.startCoor.x - this.moveCoor.x);\n    const _y = Math.abs(this.startCoor.y - this.moveCoor.y);\n    let isPress = false;\n    if (_x <= ASSERT_MOVE && _y <= ASSERT_MOVE) {\n      isPress = true;\n    }\n    return { isPress, isMove: !isPress };\n  }\n\n  // 设置当前场景\n  setScene(scene) {\n    console.log('---------------------' + scene);\n    this.scene = scene;\n  }\n\n  // 设置当前动作\n  setAction(action) {\n    console.log('---------------------' + action);\n    this.action = action;\n  }\n\n  // 一个事件的结束\n  eventOver(e) {\n    if (typeof this.over === 'function') this.over(e);\n    this.initData();\n  }\n}\n","import MouseHandler from './mouse-handler';\n\nexport default class UseMoveList {\n  /*\n   * options只需要传入 id, wrapHeight: 480, domWidth: 480, domHeight: Y, direction: 'y',\n   * id元素布局必需是非static，内部项的style尽量为null\n   * 所有移动块上需设置name=\"move-block\" :move-index=\"key\"\n   * 当进行布局时，将会是一个非常耗费性能的操作\n   * */\n  constructor(options) {\n    /*\n     * 这里仅获取当前调用组件内的元素\n     * 若是其他地方有重复组件（如首屏滑块），需要将排序数据存入store\n     * */\n    if (options.el instanceof Node) this.el = options.el;\n    else throw Error('el must be a Element');\n    this.currentDom = null; // 当前变动位置的元素\n    this.currentKey = null; // 当前变动位置的元素索引\n    // 移动中排序定时器\n    this.moveTimer = null;\n    // 移动排序后调整鼠标移动值\n    this.startELP = null;\n    this.fixMouseX = 0;\n    this.fixMouseY = 0;\n    /*\n     * 设置需要进行排序的doms\n     * 若是没有传入domlist，将会去wrap内的子元素\n     * */\n    if (options.domList instanceof Array) {\n      this.domList = options.domList;\n    } else {\n      this.domList = Array.prototype.map.call(this.el.children, (item) => item);\n    }\n    delete options.domList;\n    /*\n     * 实例化鼠标事件\n     * */\n    this.initMouse(options);\n  }\n\n  initMouse(options) {\n    let press = false;\n    this.scrollBody = new MouseHandler(options);\n    this.scrollBody.press = (e) => {\n      console.log(e);\n      press = true;\n      this.scrollBody.stop = true;\n      this.findElement(e.path);\n      this.initDomList(); // 初始化DomList\n    };\n    this.scrollBody.move = (e, start, end) => {\n      // 监听移动，并变更移动块位置\n      if (press) {\n        this.moveTimerHandler();\n        this.setMovePosition(start, end);\n      }\n    };\n    this.scrollBody.over = (e) => {\n      if (press) {\n        // 当鼠标松开时执行的方法\n        this.setFreeElement();\n      }\n      press = false;\n      this.scrollBody.stop = false;\n    };\n  }\n\n  /*\n   * 初始化元素的位置信息\n   * */\n  initDomList() {\n    this.positions = this.domList.map((dom, key) => {\n      const top = dom.offsetTop;\n      const left = dom.offsetLeft;\n      const width = dom.clientWidth;\n      const height = dom.clientHeight;\n      return {\n        key,\n        top,\n        left,\n        width,\n        height,\n        scopeX: [left, left + width],\n        scopeY: [top, top + height]\n      };\n    });\n    this.positionsCopy = [...this.positions];\n    const position = this.positions[this.currentKey];\n    this.startELP = {\n      top: position.top,\n      left: position.left\n    };\n    this.setDomPosition();\n  }\n\n  /*\n   * 找到当前选中的移动元素\n   * */\n  findElement(path) {\n    path.forEach((dom, key) => {\n      if (dom.getAttribute && dom.getAttribute('name') === 'move-block') {\n        this.currentDom = dom;\n        this.currentKey = Number(dom.getAttribute('move-index'));\n      }\n    });\n  }\n\n  /*\n   * 设置doms位置\n   * */\n  setDomPosition() {\n    const currentKey = this.currentKey;\n    setTimeout(() => {\n      this.domList.forEach((dom, key) => {\n        const postion = this.positions[key];\n        dom.style = `\n          ${currentKey === key ? 'border-color:red;' : ''}\n          position:absolute;\n          top:${postion.top}px;\n          left:${postion.left}px;\n          transform:translate(0, 0);\n          z-index:100;\n        `;\n      });\n    }, 0);\n  }\n\n  /*\n   * 设置滑动位置\n   * */\n  setMovePosition(start, end) {\n    const moveX = end.x - start.x + this.fixMouseX;\n    const moveY = end.y - start.y + this.fixMouseY;\n    const currentXY = this.positions[this.currentKey];\n    currentXY.moveX = moveX;\n    currentXY.moveY = moveY;\n    this.currentDom.style = `\n      border-color:red;\n      position:absolute;\n      top:${currentXY.top}px;\n      left:${currentXY.left}px;\n      transform:translate(${moveX}px, ${moveY}px);\n      z-index:200;\n    `;\n  }\n\n  /**\n   * 设置松开事件\n   */\n  setFreeElement() {\n    const currentXY = this.positions[this.currentKey];\n    const style = `\n      position:absolute;\n      top:${currentXY.top}px;\n      left:${currentXY.left}px;\n      transform:translate(0, 0);\n      z-index:100;\n    `;\n    this.currentDom.style = `\n      ${style}\n      transition: all 0.5s;\n    `;\n    setTimeout(() => {\n      this.currentDom.style = style;\n    }, 500);\n  }\n\n  /**\n   * 记录移动过程中的信息，并设置定时器，处理排序任务\n   */\n  moveTimerHandler(position) {\n    if (this.moveTimer) clearTimeout(this.moveTimer);\n    this.moveTimer = setTimeout(() => {\n      this.resetQuene();\n    }, 500);\n  }\n\n  /**\n   * 当鼠标停下超过500毫秒，将会判断是否触发排序\n   */\n  resetQuene() {\n    const currentXY = this.positions[this.currentKey];\n    const currentX = currentXY.left + currentXY.moveX;\n    const currentY = currentXY.top + currentXY.moveY;\n    const currentKey = this.currentKey;\n    this.positions.forEach((position, key) => {\n      if (currentKey !== key) {\n        const _x = Math.abs(position.left - currentX);\n        const _y = Math.abs(position.top - currentY);\n        if (_x <= 30 && _y <= 30) {\n          console.log('重新排序：' + this.currentKey + '---to---' + key);\n          delete currentXY.moveX;\n          delete currentXY.moveY;\n          const next = this.positions[key];\n          // 当往前排时，替换的元素往前挪\n          /** 对positions重新排序 **/\n          if (currentKey < key) {\n            for (let i = currentKey + 1; i <= key; i++) {\n              this.positions[i] = this.positionsCopy[i - 1];\n            }\n          } else {\n            // 当往后排时，替换的元素往后挪\n            for (let i = key; i < currentKey; i++) {\n              this.positions[i] = this.positionsCopy[i + 1];\n            }\n          }\n          this.positions[currentKey] = {\n            ...next,\n            ...{\n              moveX: currentX - next.left,\n              moveY: currentY - next.top\n            }\n          };\n          // 重置鼠标移动位置，\n          // 若是再次改变位置，移动位置出现\n          this.fixMouseX = this.startELP.left - next.left;\n          this.fixMouseY = this.startELP.top - next.top;\n          this.resetQueneDom();\n        }\n      }\n    });\n  }\n\n  /**\n   * 针对重新排的position设置位置\n   * 注：dom顺序不变，绝对定位变了\n   */\n  resetQueneDom() {\n    const currentKey = this.currentKey;\n    this.positions.forEach((position, key) => {\n      const dom = this.domList[key];\n      const style = `\n        ${currentKey === key ? 'border-color:red;' : ''}\n        position:absolute;\n        top:${position.top}px;\n        left:${position.left}px;\n        transform:translate(${position.moveX}px, ${position.moveY}px);\n        z-index:${currentKey === key ? '200' : '100'};\n      `;\n      dom.style = `${style}transition: all 0.5s;`;\n      setTimeout(() => {\n        dom.style = style;\n      }, 500);\n    });\n  }\n}\n"],"names":["ASSERT_MOVE","ASSERT_PRESS","MouseHandler","options","el","Node","Error","$options","initData","addEventListener","mousedown","bind","mousemove","document","mouseup","scene","action","downtime","uptime","startCoor","x","y","moveCoor","endCoor","stop","e","stopPropagation","setAction","Date","getTime","setTimeout","console","log","assertPressOrMove","isPress","setScene","press","pressDelay","move","during","click","pressEnd","eventOver","_x","Math","abs","_y","isMove","over","UseMoveList","currentDom","currentKey","moveTimer","startELP","fixMouseX","fixMouseY","domList","Array","prototype","map","call","children","item","initMouse","scrollBody","findElement","path","initDomList","start","end","moveTimerHandler","setMovePosition","setFreeElement","positions","dom","key","top","offsetTop","left","offsetLeft","width","clientWidth","height","clientHeight","scopeX","scopeY","positionsCopy","position","setDomPosition","forEach","getAttribute","Number","postion","style","moveX","moveY","currentXY","clearTimeout","resetQuene","currentX","currentY","next","i","resetQueneDom"],"mappings":"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"}