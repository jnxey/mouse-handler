{"version":3,"file":"UseDragSort.dev.js","sources":["../src/core/log.js","../src/core/mouse-handler.js","../src/core/mouse-dragsort.js","../src/core/mouse-scroll-y.js","../src/index.js"],"sourcesContent":["export const types = {};\r\n\r\nexport const openLog = (type) => {\r\n  types[type] = true;\r\n};\r\n\r\nexport const cloneLog = (type) => {\r\n  types[type] = false;\r\n};\r\n\r\nexport const printLog = (message, type) => {\r\n  if (types[type] || type === undefined) {\r\n    console.log(message);\r\n  }\r\n};\r\n","import { printLog, openLog } from './log';\r\n\r\nopenLog('mouse-handler');\r\n\r\n// 事件\r\nconst EVENT_TYPE = {\r\n  click: 'click', // 点击事件\r\n  press: 'press', // 长按事件\r\n  pressEnd: 'pressEnd', // 长按结束\r\n  move: 'move' // 移动\r\n};\r\n\r\nconst ASSERT_MOVE = 20; // 断言长按与移动,px\r\nconst ASSERT_PRESS = 300; // 断言点击长按,ms\r\n\r\n// 监听一个元素内的鼠标事件\r\nexport default class MouseHandler {\r\n  constructor(options) {\r\n    if (options.el instanceof Node) this.el = options.wrap || options.el;\r\n    else throw Error('el must be a Element');\r\n    this.$options = options; // 内含一系列钩子\r\n    this.initData();\r\n    /*\r\n     * 每次鼠标动作都有3个状态\r\n     * 按下、移动、抬起（down，move，up）\r\n     * 通过分析动作，确定鼠标操作的场景，并抛出一系列的钩子\r\n     * --------------------\r\n     * 场景包括:\r\n     * 点击 * 长按 * 移动 * 上滑 * 下滑 * 左->右 * 右->左 * 顶部边缘下滑 * 底部边缘上滑 * 左边缘右滑 * 右边缘左滑\r\n     * --------------------\r\n     * 钩子包括:\r\n     * click * press * pressEnd * toTop * toBottom * leftToRight * rightToleft * topEdge * bottomEdge * leftEdge * rightEdge\r\n     * --------------------\r\n     * 现在先分析 长按->拖拽 场景\r\n     * */\r\n    this.el.addEventListener('mousedown', this.mousedown.bind(this));\r\n    this.el.addEventListener('mousemove', this.mousemove.bind(this));\r\n    // this.el.addEventListener('mouseup', this.mouseup.bind(this));\r\n    document.addEventListener('mouseup', this.mouseup.bind(this));\r\n  }\r\n\r\n  // 初始化值\r\n  initData() {\r\n    this.scene = null; // 当前动作场景\r\n    this.action = null; // 动作状态\r\n    this.downtime = 0; // 按下时的时间\r\n    this.uptime = 0; //抬起的时间\r\n    this.startCoor = { x: 0, y: 0 }; // 按下时鼠标位置\r\n    this.moveCoor = { x: 0, y: 0 }; // 移动时鼠标位置\r\n    this.endCoor = { x: 0, y: 0 }; // 放开时时鼠标位置\r\n    this.stop = false;\r\n  }\r\n\r\n  // 鼠标按下\r\n  mousedown(e) {\r\n    if (this.stop) e.stopPropagation();\r\n    this.setAction('down'); // 鼠标按下\r\n    this.downtime = new Date().getTime();\r\n    this.startCoor = { x: e.x, y: e.y };\r\n    if (typeof this.down === 'function') this.down(e);\r\n    setTimeout(() => {\r\n      // 当超过断言值时\r\n      printLog('action------------------------' + this.action, 'mouse-handler');\r\n      if (this.action && this.action !== 'up' && this.assertPressOrMove().isPress) {\r\n        this.setScene('press');\r\n        if (typeof this.press === 'function') this.press(e);\r\n      }\r\n    }, this.$options.pressDelay || ASSERT_PRESS);\r\n  }\r\n\r\n  // 鼠标移动\r\n  mousemove(e) {\r\n    if (this.stop) e.stopPropagation();\r\n    this.moveCoor = { x: e.x, y: e.y };\r\n    // this.setAction('move'); // 鼠标按下\r\n    if (typeof this.move === 'function') this.move(e, this.startCoor, this.moveCoor);\r\n  }\r\n\r\n  // 鼠标抬起\r\n  mouseup(e) {\r\n    if (this.stop) e.stopPropagation();\r\n    this.setAction('up'); // 鼠标按下\r\n    this.uptime = new Date().getTime();\r\n    const during = this.uptime - this.downtime;\r\n    this.endCoor = { x: e.x, y: e.y };\r\n    // 断言是点击还是长按：scene未被设置，且点击间隔少于 ASSERT_PRESS\r\n    if (during <= (this.$options.pressDelay || ASSERT_PRESS)) {\r\n      this.setScene('click');\r\n      if (typeof this.click === 'function') this.click(e);\r\n    } else if (this.assertPressOrMove().isPress) {\r\n      this.setScene('pressEnd');\r\n      if (typeof this.pressEnd === 'function') this.pressEnd(e);\r\n    }\r\n    this.eventOver();\r\n  }\r\n\r\n  // 断言当前是长按还是移动，\r\n  assertPressOrMove() {\r\n    const _x = Math.abs(this.startCoor.x - this.moveCoor.x);\r\n    const _y = Math.abs(this.startCoor.y - this.moveCoor.y);\r\n    let isPress = false;\r\n    if (_x <= ASSERT_MOVE && _y <= ASSERT_MOVE) {\r\n      isPress = true;\r\n    }\r\n    return { isPress, isMove: !isPress };\r\n  }\r\n\r\n  // 设置当前场景\r\n  setScene(scene) {\r\n    printLog('---------------------' + scene, 'mouse-handler');\r\n    this.scene = scene;\r\n  }\r\n\r\n  // 设置当前动作\r\n  setAction(action) {\r\n    printLog('---------------------' + action, 'mouse-handler');\r\n    this.action = action;\r\n  }\r\n\r\n  // 一个事件的结束\r\n  eventOver(e) {\r\n    if (typeof this.over === 'function') this.over(e);\r\n    this.initData();\r\n  }\r\n}\r\n","import { printLog, openLog, deepCopy } from './log';\r\nimport MouseHandler from './mouse-handler';\r\n\r\nopenLog('move-block');\r\n\r\nexport default class UseDragSort {\r\n  /*\r\n   * id元素布局必需是非static，内部项的style尽量为null\r\n   * 所有移动块上需设置name=\"move-block\" :move-index=\"key\"\r\n   * 当进行布局时，将会是一个非常耗费性能的操作\r\n   * */\r\n  constructor(options) {\r\n    /*\r\n     * 这里仅获取当前调用组件内的元素\r\n     * 若是其他地方有重复组件（如首屏滑块），需要将排序数据存入store\r\n     * */\r\n    if (options.el instanceof Node) this.el = options.el;\r\n    else throw Error('el must be a Element');\r\n    this.currentDom = null; // 当前变动位置的元素\r\n    this.currentKey = null; // 当前变动位置的元素索引\r\n    // 移动中排序定时器\r\n    this.moveTimer = null;\r\n    /*\r\n     * 实例化鼠标事件\r\n     * */\r\n    this.initMouse(options);\r\n    // 获取与重置数据源\r\n    this.getList = options.getList;\r\n    this.resetList = options.resetList;\r\n    // 移动中的样式\r\n    this.activeClass = options.activeClass || '';\r\n    this.currentBaseClass = '';\r\n    this.scroll = options.scroll;\r\n    this.fixScrollY = 0;\r\n    this.cacheMove = null;\r\n  }\r\n\r\n  // 查找滚动元素\r\n  getScrollEle() {\r\n    // 找到父级是否有需要滚动的元素\r\n    let result = null;\r\n    const parents = findParents(this.el);\r\n    parents.forEach((ele) => {\r\n      if(ele.getAttribute('scroll') === 'y') {\r\n        result = {\r\n          dom: ele,\r\n          x: ele.clientWidth,\r\n          y: ele.clientHeight\r\n        };\r\n      }\r\n    });\r\n    return result;\r\n  }\r\n\r\n  // 初始化鼠标事件\r\n  initMouse(options) {\r\n    let press = false;\r\n    this.scrollBody = new MouseHandler(options);\r\n    // 长按动作\r\n    this.scrollBody.press = (e) => {\r\n      press = true;\r\n      this.scrollBody.stop = true;\r\n      this.initDomList(e); // 初始化DomList\r\n    };\r\n    // 移动动作\r\n    this.scrollBody.move = (e, start, end) => {\r\n      // 监听移动，并变更移动块位置\r\n      if(this.scroll) this.scroll.stopScrolly();\r\n      if (press && this.currentKey !== null) {\r\n        this.moveTimerHandler();\r\n        this.setMovePosition(start, end);\r\n      }\r\n    };\r\n    // 结束动作\r\n    this.scrollBody.over = (e) => {\r\n      if (press && this.currentKey !== null) {\r\n        // 当鼠标松开时执行的方法\r\n        this.moveOver();\r\n      }\r\n      press = false;\r\n      this.scrollBody.stop = false;\r\n    };\r\n  }\r\n\r\n  /*\r\n   * 初始化元素的位置信息\r\n   * */\r\n  initDomList(e) {\r\n    this.scrollEle = this.getScrollEle();\r\n    /*\r\n     * 设置需要进行排序的doms\r\n     * */\r\n    this.domList = Array.prototype.map.call(\r\n      this.el.querySelectorAll('[name=move-block]'),\r\n      (item) => item\r\n    );\r\n    /**\r\n     * 注意：这里的positions与domList的顺序可能不一致（根据y、x轴进行排序）\r\n     */\r\n    this.positions = this.domList.map((dom, key) => {\r\n      const parent = dom.parentElement;\r\n      const top = parent.offsetTop;\r\n      const left = parent.offsetLeft;\r\n      const width = dom.clientWidth;\r\n      const height = dom.clientHeight;\r\n      const unid = dom.getAttribute('unid');\r\n      return {\r\n        unid,\r\n        key,\r\n        top,\r\n        left,\r\n        width,\r\n        height,\r\n        scopeX: [left, left + width],\r\n        scopeY: [top, top + height],\r\n        translate: {\r\n          x: 0,\r\n          y: 0\r\n        }\r\n      };\r\n    });\r\n    this.resetPositions();\r\n    this.findElement(e.getPath());\r\n    this.setDomPosition();\r\n  }\r\n\r\n  /*\r\n   * 找到当前选中的移动元素\r\n   * */\r\n  findElement(path) {\r\n    path.forEach((dom, key) => {\r\n      if (dom.getAttribute && dom.getAttribute('name') === 'move-block') {\r\n        this.currentDom = dom;\r\n        this.currentBaseClass = dom.getAttribute('class');\r\n        this.currentKey = this.positions.findIndex(\r\n          (v) => v.key === Number(dom.getAttribute('move-index'))\r\n        );\r\n        this.currentDom.setAttribute('class', this.currentBaseClass + ' ' + this.activeClass);\r\n      }\r\n    });\r\n  }\r\n\r\n  /*\r\n   * 设置滑动位置\r\n   * */\r\n  setMovePosition(start, end) {\r\n    this.cacheMove = { start, end };\r\n    const moveX = end.x - start.x;\r\n    const moveY = end.y - start.y + this.fixScrollY;\r\n    const currentXY = this.positions[this.currentKey];\r\n    const translate = currentXY.moving || currentXY.translate;\r\n    currentXY.moveX = moveX;\r\n    currentXY.moveY = moveY;\r\n    this.currentDom.setAttribute(\r\n      'style',\r\n      `\r\n      position:absolute;\r\n      top:0;\r\n      left:0;\r\n      transform:translate(${translate.x + moveX}px, ${translate.y + moveY}px);\r\n      z-index: 100;\r\n    `\r\n    );\r\n  }\r\n\r\n  /*\r\n   * 向上滚动 -1\r\n   * */\r\n  scrollTop() {\r\n    if(!this.cacheMove) return;\r\n    this.fixScrollY -= 1;\r\n    this.setMovePosition(this.cacheMove.start, this.cacheMove.end);\r\n  }\r\n\r\n  /*\r\n   * 向下滚动 +1\r\n   * */\r\n  scrollBottom() {\r\n    if(!this.cacheMove) return;\r\n    this.fixScrollY += 1;\r\n    this.setMovePosition(this.cacheMove.start, this.cacheMove.end);\r\n  }\r\n\r\n  /*\r\n   * 设置开始移动doms位置\r\n   * */\r\n  setDomPosition() {\r\n    if (this.currentKey === null) return;\r\n    const currentXY = this.positions[this.currentKey];\r\n    const translate = currentXY.translate;\r\n    this.currentDom.setAttribute(\r\n      'style',\r\n      `\r\n      position:absolute;\r\n      top:0;\r\n      left:0;\r\n      transform:translate(${translate.x}px, ${translate.y}px);\r\n      z-index: 100;\r\n    `\r\n    );\r\n  }\r\n\r\n  /**\r\n   * 解放元素\r\n   */\r\n  setFreeElement() {\r\n    const currentXY = this.positions[this.currentKey];\r\n    const translate = currentXY.translate;\r\n    delete currentXY.moving;\r\n    const style = `\r\n      transform:translate(${translate.x}px, ${translate.y}px);\r\n    `;\r\n    this.currentDom.setAttribute(\r\n      'style',\r\n      `\r\n      ${style}\r\n      position:absolute;\r\n      top:0;\r\n      left:0;\r\n      transition: all 0.5s;\r\n      z-index: 100;\r\n    `\r\n    );\r\n    setTimeout(() => {\r\n      this.currentDom.setAttribute('class', this.currentBaseClass);\r\n      this.currentDom.setAttribute('style', style);\r\n    }, 500);\r\n  }\r\n\r\n  /**\r\n   * 记录移动过程中的信息，并设置定时器，处理排序任务\r\n   */\r\n  moveTimerHandler(position) {\r\n    if (this.moveTimer) clearTimeout(this.moveTimer);\r\n    this.moveTimer = setTimeout(() => {\r\n      const status = this.resetQuene();\r\n      if(status === 'none') {\r\n        // 判断是否处于需要上下滚动的内容中\r\n        if(this.scrollEle && this.scroll) {\r\n          const scrollDOM = this.scrollEle.dom;\r\n          const currentDOM = this.currentDom;\r\n          const scrollRECT = this.scrollEle;\r\n          const currentXY = this.positions[this.currentKey];\r\n          const translate = { x: currentXY.moveX, y: currentXY.moveY};\r\n          const offset = getOffsetDOM(this.currentDom, scrollDOM, translate);\r\n          console.log('scrollRECT' + JSON.stringify(scrollRECT));\r\n          console.log('offset' + JSON.stringify(offset));\r\n          console.log('currentDOM' + JSON.stringify(currentDOM.clientHeight));\r\n          const status = judgeScroll(scrollRECT, offset, currentDOM.clientHeight, this.fixScrollY, this.scroll.scrollY);\r\n          if(status === 'top') {\r\n            this.scroll.startToTop(() => {\r\n              this.scrollTop();\r\n            });\r\n          } else if(status === 'bottom') {\r\n            this.scroll.startToBottom(() => {\r\n              this.scrollBottom();\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }, 300);\r\n  }\r\n\r\n  /**\r\n   * 当鼠标停下超过300毫秒，将会判断是否触发排序\r\n   */\r\n  resetQuene() {\r\n    let result = 'none';\r\n    const currentXY = this.positions[this.currentKey];\r\n    const currentTranslate = currentXY.moving || currentXY.translate;\r\n    const currentX = currentXY.left + currentXY.moveX + currentTranslate.x;\r\n    const currentY = currentXY.top + currentXY.moveY + currentTranslate.y;\r\n    const currentKey = this.currentKey;\r\n    this.positions.forEach((position, key) => {\r\n      if (currentKey !== key) {\r\n        const translate = position.translate;\r\n        const _x = Math.abs(position.left + translate.x - currentX);\r\n        const _y = Math.abs(position.top + translate.y - currentY);\r\n        if (_x <= 30 && _y <= 30) {\r\n          printLog('重新排序：' + this.currentKey + '---to---' + key, 'move-block');\r\n          result = 'resort';\r\n          // 当往前排时，替换的元素往前挪\r\n          /** 对positions重新排序 **/\r\n          const moveInfo = this.cacheChangePositions(currentKey, key, this.positions);\r\n          moveInfo.forEach((move) => {\r\n            printLog(move, 'move-block');\r\n            if (move.moving) this.positions[move.from].moving = move.moving;\r\n            this.positions[move.from].translate = move.translate;\r\n          });\r\n          // 排序动作\r\n          this.resetQueneDom();\r\n          // 重新对positions进行排序\r\n          this.currentKey = key;\r\n          this.resetPositions();\r\n        }\r\n      }\r\n    });\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * 缓存位置变更信息\r\n   */\r\n  cacheChangePositions(currentKey, key, positions) {\r\n    let moveInfo = [];\r\n    moveInfo.push({\r\n      from: currentKey,\r\n      to: key,\r\n      translate: { ...this.domToPosition(positions[currentKey], positions[key]) },\r\n      moving: { ...(positions[currentKey].moving || positions[currentKey].translate) }\r\n    });\r\n    if (currentKey < key) {\r\n      // 当往前排时，currentKey - key 的元素往前挪\r\n      for (let i = currentKey + 1; i <= key; i++) {\r\n        moveInfo.push({\r\n          from: i,\r\n          to: i - 1,\r\n          translate: { ...this.domToPosition(positions[i], positions[i - 1]) }\r\n        });\r\n      }\r\n    } else {\r\n      // 当往后排时，key - currentKey 的元素往后挪\r\n      for (let i = key; i < currentKey; i++) {\r\n        moveInfo.push({\r\n          from: i,\r\n          to: i - 1,\r\n          translate: { ...this.domToPosition(positions[i], positions[i + 1]) }\r\n        });\r\n      }\r\n    }\r\n    return moveInfo;\r\n  }\r\n\r\n  /**\r\n   * 移动一个元素到后一个的位置\r\n   */\r\n  domToPosition(p1, p2) {\r\n    const x = p2.left + p2.translate.x - p1.left;\r\n    const y = p2.top + p2.translate.y - p1.top;\r\n    return { x, y };\r\n  }\r\n\r\n  /**\r\n   * 针对重新排的position设置位置\r\n   * 注：dom顺序不变，绝对定位变了\r\n   */\r\n  resetQueneDom() {\r\n    const currentKey = this.currentKey;\r\n    this.positions.forEach((position, key) => {\r\n      if (currentKey === key) return;\r\n      const dom = this.domList[position.key];\r\n      const translate = position.translate;\r\n      const style = `\r\n        transform:translate(${translate.x}px, ${translate.y}px);\r\n      `;\r\n      dom.setAttribute(\r\n        'style',\r\n        `${style}\r\n        transition: all 0.5s;\r\n      `\r\n      );\r\n      setTimeout(() => {\r\n        dom.setAttribute('style', style);\r\n      }, 500);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 重新对positions进行排序\r\n   * 首先根据纵坐标排序，再进行横坐标排序\r\n   * 排序方式，从小到大\r\n   */\r\n  resetPositions() {\r\n    this.positions = this.positions.sort(function (a, b) {\r\n      const ayx =\r\n        ('0000000000' + (a.top + a.translate.y)).slice(-10) +\r\n        ('0000000000' + (a.left + a.translate.x)).slice(-10);\r\n      const byx =\r\n        ('0000000000' + (b.top + b.translate.y)).slice(-10) +\r\n        ('0000000000' + (b.left + b.translate.x)).slice(-10);\r\n      return ayx > byx ? 1 : -1;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 设置松开事件\r\n   */\r\n  moveOver() {\r\n    this.setFreeElement();\r\n    setTimeout(() => {\r\n      this.resortdom();\r\n      // 对数据进行清空\r\n      this.resetData();\r\n    }, 500);\r\n  }\r\n\r\n  /**\r\n   * 对dom进行重写排序\r\n   */\r\n  resortdom() {\r\n    let result = [];\r\n    let list = this.getList();\r\n    this.positions.forEach((position, key) => {\r\n      result[key] = list[position.key];\r\n    });\r\n    this.domList.forEach((dom) => {\r\n      dom.setAttribute('style', '');\r\n    });\r\n    this.resetList(result);\r\n  }\r\n\r\n  /**\r\n   * 清空数据\r\n   */\r\n  resetData() {\r\n    clearTimeout(this.moveTimer);\r\n    this.moveTimer = null;\r\n    this.positions = null;\r\n    this.currentKey = null;\r\n    this.currentDom = null;\r\n    this.domList = [];\r\n    this.scrollEle = null;\r\n    this.cacheMove = null;\r\n    this.fixScrollY = 0;\r\n  }\r\n\r\n  /**\r\n   * 销毁实例缓存\r\n   */\r\n  destory() {\r\n    clearTimeout(this.moveTimer);\r\n    this.moveTimer = null;\r\n    this.positions = null;\r\n    this.currentKey = null;\r\n    this.currentDom = null;\r\n    this.domList = [];\r\n    this.scrollEle = null;\r\n    this.cacheMove = null;\r\n    this.fixScrollY = 0;\r\n    // 全部清除\r\n    this.el = null;\r\n    this.scroll = null;\r\n    \r\n  }\r\n}\r\n\r\n/**\r\n * 查找某一个元素的父级\r\n */\r\nfunction findParents(Node) {\r\n  let result = [Node];\r\n  const target = Node;\r\n  let parent = target.parentElement;\r\n  while (parent) {\r\n    result.push(parent);\r\n    parent = parent.parentElement;\r\n  }\r\n  return result;\r\n}\r\n\r\n// 判定是在底部或是在顶部\r\nfunction judgeScroll(p1, p2, fixBottom, fix, scrollY) {\r\n  const value = p1.y - (p2.y - fix - scrollY);\r\n  const topValue = p1.y - 60;\r\n  const bottomValue = 60 + fixBottom;\r\n  if(value >=  topValue) {\r\n    return 'top';\r\n  } else if (value <= bottomValue) {\r\n    return 'bottom';\r\n  } else {\r\n    return 'middle';\r\n  }\r\n}\r\n// 找到当前元素与滚动元素之间所有doms\r\nfunction findInDOM(start, end) {\r\n  let result = [];\r\n  let parent = start;\r\n  while(parent && parent !== end) {\r\n    parent = parent.parentElement;\r\n    result.push(parent);\r\n  }\r\n  return result;\r\n}\r\n// 获取dom之间的相对位置\r\nfunction getOffsetDOM(start, end, translate) {\r\n  const parents = findInDOM(start, end);\r\n  let result = { x: translate.x, y: translate.y };\r\n  function getOffset(node) {\r\n    result = {\r\n      x: node.offsetLeft + result.x,\r\n      y: node.offsetTop + result.y\r\n    };\r\n  }\r\n  getOffset(start);\r\n  parents.forEach((dom) => {\r\n    getOffset(dom);\r\n  });\r\n  return result;\r\n}\r\n","import { printLog, openLog, deepCopy } from './log';\r\nimport MouseHandler from './mouse-handler';\r\n\r\nopenLog('move-block');\r\n\r\nexport default class UseScrollY {\r\n  /*\r\n   * */\r\n  constructor(options) {\r\n    /*\r\n     * 这里仅获取当前调用组件内的元素\r\n     * 若是其他地方有重复组件（如首屏滑块），需要将排序数据存入store\r\n     * */\r\n    if (options.wrap instanceof Node) this.wrap = options.wrap;\r\n    else throw Error('el must be a Element');\r\n    if (options.el instanceof Node) this.el = options.el;\r\n    else throw Error('el must be a Element');\r\n    this.scrollY = 0;\r\n    this.lastScrollY = 0; \r\n    this.maxScrollHeight = this.el.clientHeight - this.wrap.clientHeight;\r\n    /*\r\n     * 实例化鼠标事件\r\n     * */\r\n    if(this.maxScrollHeight > 0) {\r\n      this.initMouse(options);\r\n    }\r\n    this.timer = null;\r\n  }\r\n\r\n  initMouse(options) {\r\n    this.scrollBody = new MouseHandler(options);\r\n    let isScroll = null;\r\n    let isdown = false;\r\n    let startY = 0;\r\n    this.scrollBody.down = (e) => {\r\n      isdown = true;\r\n    };\r\n    // 移动动作\r\n    this.scrollBody.move = (e, start, end) => {\r\n      if(!isdown) return;\r\n      // 监听移动，并变更移动块位置\r\n      // 当纵向 / 横向 移动比例超过3，且纵向长度超过30px，即认定开始滚动\r\n      const x = end.x - start.x;\r\n      const y = end.y - start.y;\r\n      if (isScroll === null) {\r\n        const ratio = Math.abs(y) / (Math.abs(x) + 1);\r\n        if (ratio >= 3 && Math.abs(y) >= 30) {\r\n          isScroll = true;\r\n          startY = y;\r\n        }\r\n      }\r\n      if (isScroll) {\r\n        this.scrollBody.stop = true;\r\n        this.setScrollY(y - startY);\r\n      }\r\n    };\r\n\r\n    this.scrollBody.over = (e) => {\r\n      this.scrollBody.stop = false;\r\n      this.lastScrollY = this.scrollY;\r\n      isScroll = null;\r\n      isdown = false;\r\n      startY = 0;\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 设置scrolly\r\n   */\r\n  setScrollY(y, callback) {\r\n    // y表示当前鼠标按下动作过程滚动距离\r\n    let result = true;\r\n    let next = this.lastScrollY - y;\r\n    if(next < 0) {\r\n      next = 0;\r\n      result = false;\r\n    } else if(next >= this.maxScrollHeight) {\r\n      next = this.maxScrollHeight;\r\n      result = false;\r\n    }\r\n    this.scrollY = next;\r\n    this.setDomScroll(next);\r\n    return result;\r\n  }\r\n  /**\r\n   * scroll to top\r\n   */\r\n  startToTop(callback) {\r\n    this.timer = setInterval(() => {\r\n      const result = this.setScrollY(1);\r\n      this.lastScrollY = this.scrollY;\r\n      if(callback && result) callback(1);\r\n    }, 16);\r\n  }\r\n\r\n  /**\r\n   * stop scroll to bottom\r\n   */\r\n  stopScrolly() {\r\n    if(this.timer) clearInterval(this.timer);\r\n  }\r\n\r\n  /**\r\n   * scroll to bottom\r\n   */\r\n  startToBottom(callback) {\r\n    this.timer = setInterval(() => {\r\n      const result = this.setScrollY(-1);\r\n      this.lastScrollY = this.scrollY;\r\n      if(callback && result) callback(-1);\r\n    }, 16);\r\n  }\r\n\r\n  /*\r\n   * 设置元素的位置信息\r\n   * */\r\n  setDomScroll(scrolly) {\r\n    this.el.setAttribute('style', `transform:translate(0, -${scrolly}px)`);\r\n  }\r\n\r\n  /**\r\n   * 销毁实例缓存\r\n   */\r\n  destory() {\r\n    this.wrap = null;\r\n    this.el = null;\r\n  }\r\n\r\n  \r\n\r\n}\r\n","import UseDragSort from './core/mouse-dragsort';\r\nimport UseScrollY from './core/mouse-scroll-y';\r\n\r\n/*\r\n * 为mixpad的鼠标事件添加获取path的方法\r\n * */\r\nMouseEvent.prototype.getPath = function () {\r\n  if (this.path) {\r\n    return this.path;\r\n  } else {\r\n    const target = this.target;\r\n    let path = [target];\r\n    if (target instanceof Node) {\r\n      let parent = target.parentElement;\r\n      while (parent) {\r\n        path.push(parent);\r\n        parent = parent.parentElement;\r\n      }\r\n      return path;\r\n    } else {\r\n      return path;\r\n    }\r\n  }\r\n};\r\n\r\nexport default {\r\n  UseScrollY,\r\n  UseDragSort\r\n};\r\n"],"names":["types","openLog","type","printLog","message","undefined","console","log","ASSERT_MOVE","ASSERT_PRESS","MouseHandler","options","el","Node","wrap","Error","$options","initData","addEventListener","mousedown","bind","mousemove","document","mouseup","scene","action","downtime","uptime","startCoor","x","y","moveCoor","endCoor","stop","e","stopPropagation","setAction","Date","getTime","down","setTimeout","assertPressOrMove","isPress","setScene","press","pressDelay","move","during","click","pressEnd","eventOver","_x","Math","abs","_y","isMove","over","UseDragSort","currentDom","currentKey","moveTimer","initMouse","getList","resetList","activeClass","currentBaseClass","scroll","fixScrollY","cacheMove","result","parents","findParents","forEach","ele","getAttribute","dom","clientWidth","clientHeight","scrollBody","initDomList","start","end","stopScrolly","moveTimerHandler","setMovePosition","moveOver","scrollEle","getScrollEle","domList","Array","prototype","map","call","querySelectorAll","item","positions","key","parent","parentElement","top","offsetTop","left","offsetLeft","width","height","unid","scopeX","scopeY","translate","resetPositions","findElement","getPath","setDomPosition","path","findIndex","v","Number","setAttribute","moveX","moveY","currentXY","moving","style","position","clearTimeout","status","resetQuene","scrollDOM","currentDOM","scrollRECT","offset","getOffsetDOM","JSON","stringify","judgeScroll","scrollY","startToTop","scrollTop","startToBottom","scrollBottom","currentTranslate","currentX","currentY","moveInfo","cacheChangePositions","from","resetQueneDom","push","to","domToPosition","i","p1","p2","sort","a","b","ayx","slice","byx","setFreeElement","resortdom","resetData","list","target","fixBottom","fix","value","topValue","bottomValue","findInDOM","getOffset","node","UseScrollY","lastScrollY","maxScrollHeight","timer","isScroll","isdown","startY","ratio","setScrollY","callback","next","setDomScroll","setInterval","clearInterval","scrolly","MouseEvent"],"mappings":"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"}